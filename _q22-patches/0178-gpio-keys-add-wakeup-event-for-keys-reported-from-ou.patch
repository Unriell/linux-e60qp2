From 6c15d8c3474b357c116309fa4a30af1bcbcb98e9 Mon Sep 17 00:00:00 2001
From: Heiko Stuebner <heiko@sntech.de>
Date: Wed, 27 Nov 2013 14:26:11 +0100
Subject: [PATCH 178/200] gpio-keys: add wakeup-event for keys reported from
 outside (power)

and also add a reporting line
---
 drivers/input/keyboard/gpio_keys.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/drivers/input/keyboard/gpio_keys.c b/drivers/input/keyboard/gpio_keys.c
index d81fded..19a95df 100644
--- a/drivers/input/keyboard/gpio_keys.c
+++ b/drivers/input/keyboard/gpio_keys.c
@@ -364,7 +364,7 @@ static irqreturn_t gpio_keys_isr(int irq, void *dev_id)
 	BUG_ON(irq != gpio_to_irq(button->gpio));
 
 printk("%s\n", __func__);
-	pm_wakeup_event(bdata->input->dev.parent, 3000);
+	pm_wakeup_event(bdata->input->dev.parent, 2000);
 	bdata->isr_state = (gpio_get_value(button->gpio) ? 1 : 0) ^ button->active_low;
 	if (bdata->timer_debounce)
 		mod_timer(&bdata->timer,
@@ -672,6 +672,9 @@ static struct platform_driver gpio_keys_device_driver = {
 void gpiokeys_report_key(int isDown,__u16 wKeyCode)
 {
 	if (pindev) {
+		pm_wakeup_event(pindev->dev.parent, 2000);
+
+		printk("%s: code: %d, type %d, state %d\n", __func__, wKeyCode, EV_KEY, isDown);
 		input_event(pindev, EV_KEY, wKeyCode, isDown);
 		input_sync(pindev);
 	}
-- 
2.5.3

